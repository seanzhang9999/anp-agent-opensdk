<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ANP Open SDK æ¶æ„å›¾ v3.0 - åŸºäºå®é™…ä»£ç ç»“æ„</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
<style>
body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
margin: 0;
padding: 20px;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
min-height: 100vh;
}
.container {
max-width: 1600px;
margin: 0 auto;
background: white;
border-radius: 20px;
box-shadow: 0 20px 60px rgba(0,0,0,0.1);
overflow: hidden;
}
.header {
background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
color: white;
padding: 30px;
text-align: center;
}
.header h1 {
margin: 0;
font-size: 2.5em;
font-weight: 700;
text-shadow: 0 2px 10px rgba(0,0,0,0.2);
}
.header p {
margin: 10px 0 0 0;
font-size: 1.2em;
opacity: 0.9;
}
.content {
padding: 40px;
}
.diagram-container {
background: #f8f9fa;
border-radius: 15px;
padding: 30px;
margin-bottom: 40px;
box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
}
.features {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
gap: 30px;
margin-top: 40px;
}
.feature-card {
background: white;
border-radius: 15px;
padding: 30px;
box-shadow: 0 10px 30px rgba(0,0,0,0.1);
border-left: 5px solid;
transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.feature-card:hover {
transform: translateY(-5px);
box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}
.feature-card.core { border-left-color: #4caf50; }
.feature-card.service { border-left-color: #03a9f4; }
.feature-card.auth { border-left-color: #9c27b0; }
.feature-card.config { border-left-color: #ff9800; }
.feature-card h3 {
margin: 0 0 15px 0;
font-size: 1.4em;
font-weight: 600;
}
.feature-card ul {
margin: 0;
padding-left: 20px;
}
.feature-card li {
margin-bottom: 8px;
line-height: 1.6;
}
.code-block {
background: #1e1e1e;
color: #d4d4d4;
border-radius: 12px;
padding: 25px;
margin: 25px 0;
font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
font-size: 14px;
line-height: 1.6;
overflow-x: auto;
box-shadow: 0 4px 12px rgba(0,0,0,0.15);
position: relative;
white-space: pre-wrap;
}
.code-block::before {
content: 'ğŸ Python';
position: absolute;
top: 8px;
right: 15px;
background: #007acc;
color: white;
padding: 4px 8px;
border-radius: 4px;
font-size: 12px;
font-weight: 500;
}
.code-block .comment {
color: #6a9955;
}
.code-block .keyword {
color: #569cd6;
}
.code-block .string {
color: #ce9178;
}
.code-block .function {
color: #dcdcaa;
}
.code-block .decorator {
color: #4ec9b0;
}
.highlight {
background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
padding: 20px;
border-radius: 15px;
margin: 30px 0;
border-left: 5px solid #e91e63;
}
.highlight h3 {
margin: 0 0 15px 0;
color: #c2185b;
}
#mermaid-diagram {
text-align: center;
}
.mermaid {
background: white;
border-radius: 10px;
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>ğŸš€ ANP Open SDK æ¶æ„ v3.0</h1>
<p>åŸºäºå®é™…ä»£ç ç»“æ„çš„å®Œæ•´æ¶æ„å›¾</p>
</div>
<div class="content">
<div class="highlight">
<h3>ğŸ¯ åŸºäºå®é™…ä»£ç çš„æ¶æ„è®¾è®¡</h3>
<p><strong>æ ¸å¿ƒSDKï¼š</strong>anp_sdk.py, anp_agent_publisher.py, group_sdk.py<br>
<strong>æœåŠ¡å±‚ï¼š</strong>service/ ç›®å½•ä¸‹çš„å„ç§AgentæœåŠ¡<br>
<strong>è®¤è¯å±‚ï¼š</strong>auth/ ç›®å½•ä¸‹çš„DIDå’ŒJWTè®¤è¯<br>
<strong>é…ç½®å±‚ï¼š</strong>config/ ç›®å½•ä¸‹çš„åŠ¨æ€é…ç½®ç®¡ç†</p>
</div>
<div class="diagram-container">
<div id="mermaid-diagram">
<div class="mermaid">
%%{init: {'htmlLabels': true}}%%
graph TB
    %% å¼€å‘è€…åº”ç”¨å±‚
    subgraph DEV["ğŸ”§ å¼€å‘è€…åº”ç”¨å±‚"]
        BA["ä¸šåŠ¡ Agent<br>ğŸ’¼ ä½¿ç”¨ anp_sdk.py"]
        PA["å‘å¸ƒ Agent<br>ğŸ“¡ ä½¿ç”¨ anp_agent_publisher.py"]
        GA["ç¾¤ç»„ Agent<br>ğŸ‘¥ ä½¿ç”¨ group_sdk.py"]
    end

    %% ANP Open SDK æ ¸å¿ƒ
    subgraph SDK["ğŸ“¦ anp_open_sdk æ ¸å¿ƒåŒ…"]
        %% æ ¸å¿ƒSDKæ¨¡å—
        subgraph CORE_SDK["ğŸ¯ æ ¸å¿ƒSDKæ¨¡å—"]
            ANP_SDK["anp_sdk.py<br>ğŸ”‘ ä¸»è¦SDKå…¥å£<br>ğŸ“¡ Agentæ ¸å¿ƒåŠŸèƒ½"]
            AGENT_PUB["anp_agent_publisher.py<br>ğŸ“¢ Agentå‘å¸ƒæœåŠ¡<br>ğŸŒ å¯¹å¤–æ¥å£ç®¡ç†"]
            GROUP_SDK["group_sdk.py<br>ğŸ‘¥ ç¾¤ç»„ç®¡ç†<br>ğŸ’¬ ç¾¤ç»„æ¶ˆæ¯å¤„ç†"]
            GROUP_MEMBER["group_member_sdk.py<br>ğŸ‘¤ ç¾¤ç»„æˆå‘˜ç®¡ç†<br>ğŸ­ è§’è‰²æƒé™æ§åˆ¶"]
            USER_TOOL["anp_user_tool.py<br>ğŸ› ï¸ ç”¨æˆ·å·¥å…·é›†<br>âš™ï¸ å®ç”¨åŠŸèƒ½"]
            MAIL_MGR["mail_manager.py<br>ğŸ“§ é‚®ä»¶ç®¡ç†<br>ğŸ“¨ å¢å¼ºé‚®ä»¶åŠŸèƒ½"]
        end

        %% æœåŠ¡å±‚
        subgraph SERVICE_LAYER["ğŸš€ service æœåŠ¡å±‚"]
            AGENT_API["agent_api_call.py<br>ğŸ“ Agent APIè°ƒç”¨<br>ğŸ”— å¤–éƒ¨æ¥å£é›†æˆ"]
            AGENT_AUTH["agent_auth.py<br>ğŸ” Agentè®¤è¯æœåŠ¡<br>ğŸ›¡ï¸ å®‰å…¨éªŒè¯"]
            MSG_GROUP["agent_message_group.py<br>ğŸ‘¥ ç¾¤ç»„æ¶ˆæ¯æœåŠ¡<br>ğŸ“¢ ç¾¤ç»„é€šä¿¡"]
            MSG_P2P["agent_message_p2p.py<br>ğŸ’¬ P2Pæ¶ˆæ¯æœåŠ¡<br>ğŸ¤ ç‚¹å¯¹ç‚¹é€šä¿¡"]
            LOCAL_ACC["local_agent_accelerator.py<br>âš¡ æœ¬åœ°åŠ é€Ÿå™¨<br>ğŸš€ æ€§èƒ½ä¼˜åŒ–"]
            ROUTER_AGENT["router_agent.py<br>ğŸ”„ Agentè·¯ç”±<br>ğŸ“¡ æ¶ˆæ¯è·¯ç”±"]
            ROUTER_AUTH["router_auth.py<br>ğŸ” è·¯ç”±è®¤è¯<br>ğŸ›¡ï¸ è·¯ç”±å®‰å…¨"]
            ROUTER_DID["router_did.py<br>ğŸ†” DIDè·¯ç”±<br>ğŸ“‹ èº«ä»½è·¯ç”±"]
            ROUTER_PUB["router_publisher.py<br>ğŸ“¢ å‘å¸ƒè·¯ç”±<br>ğŸŒ å‘å¸ƒç®¡ç†"]
        end

        %% è®¤è¯å±‚
        subgraph AUTH_LAYER["ğŸ” auth è®¤è¯å±‚"]
            AUTH_MW["auth_middleware.py<br>ğŸ›¡ï¸ è®¤è¯ä¸­é—´ä»¶<br>ğŸ”’ è¯·æ±‚æ‹¦æˆª"]
            DID_AUTH["did_auth.py<br>ğŸ†” DIDè®¤è¯<br>ğŸ“œ å»ä¸­å¿ƒåŒ–èº«ä»½"]
            TOKEN_AUTH["token_auth.py<br>ğŸ« Tokenè®¤è¯<br>ğŸ”‘ ä»¤ç‰Œç®¡ç†"]
            JWT_KEYS["jwt_keys.py<br>ğŸ” JWTå¯†é’¥<br>ğŸ—ï¸ å¯†é’¥ç®¡ç†"]
            DID_RESOLVER["custom_did_resolver.py<br>ğŸ” DIDè§£æå™¨<br>ğŸ“‹ èº«ä»½è§£æ"]
            VC_HELPER["vc_helper.py<br>ğŸ“œ å¯éªŒè¯å‡­è¯<br>âœ… å‡­è¯åŠ©æ‰‹"]
        end

        %% é…ç½®å±‚
        subgraph CONFIG_LAYER["âš™ï¸ config é…ç½®å±‚"]
            CONFIG_CORE["config.py<br>âš™ï¸ æ ¸å¿ƒé…ç½®<br>ğŸ“‹ åŸºç¡€è®¾ç½®"]
            DYN_CONFIG["dynamic_config.py<br>ğŸ”„ åŠ¨æ€é…ç½®<br>ğŸ“ è¿è¡Œæ—¶é…ç½®"]
            PATH_RESOLVER["path_resolver.py<br>ğŸ“‚ è·¯å¾„è§£æ<br>ğŸ—‚ï¸ æ–‡ä»¶è·¯å¾„ç®¡ç†"]
        end

        %% è¿æ¥çƒ­è¡¥ä¸
        subgraph HOTPATCH["ğŸ”§ agent_connect_hotpatch"]
            DID_WBA["did_wba.py<br>ğŸŒ WBAè®¤è¯<br>ğŸ”— Web-basedè®¤è¯"]
            WBA_HEADER["did_wba_auth_header.py<br>ğŸ“‹ WBAè®¤è¯å¤´<br>ğŸ·ï¸ è®¤è¯æ ‡å¤´"]
        end
    end

    %% å¤–éƒ¨å·¥å…·å’Œé…ç½®
    subgraph EXTERNAL["ğŸ› ï¸ å¤–éƒ¨å·¥å…·å’Œé…ç½®"]
        UTILS["utils/log_base.py<br>ğŸ“ æ—¥å¿—åŸºç¡€<br>ğŸ” æ—¥å¿—ç®¡ç†"]
        CONFIG_FILES["é…ç½®æ–‡ä»¶<br>ğŸ“„ .env, .yaml<br>âš™ï¸ ç¯å¢ƒé…ç½®"]
        EXAMPLES["examples<br>ğŸ“š ä½¿ç”¨ç¤ºä¾‹<br>ğŸ’¡ æœ€ä½³å®è·µ"]
    end

    %% å®šä¹‰èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ï¼ˆä»å„å­å›¾ä¸­é€‰å–ä»£è¡¨èŠ‚ç‚¹ï¼‰
    BA --> ANP_SDK
    AGENT_PUB --> AGENT_API
    ANP_SDK --> AUTH_MW
    USER_TOOL --> CONFIG_CORE
    DID_WBA --> DID_AUTH
    CONFIG_FILES --> CONFIG_CORE
    UTILS --> ANP_SDK

</div>
</div>
</div>

<div class="code-block"><span class="comment"># ğŸ¯ åŸºäºå®é™…ä»£ç ç»“æ„çš„SDKä½¿ç”¨ç¤ºä¾‹</span>
<span class="keyword">from</span> anp_open_sdk.anp_sdk <span class="keyword">import</span> ANPSDKCore
<span class="keyword">from</span> anp_open_sdk.anp_agent_publisher <span class="keyword">import</span> AgentPublisher
<span class="keyword">from</span> anp_open_sdk.group_sdk <span class="keyword">import</span> GroupSDK
<span class="keyword">from</span> anp_open_sdk.config.config <span class="keyword">import</span> ANPConfig
<span class="keyword">from</span> anp_open_sdk.config.dynamic_config <span class="keyword">import</span> DynamicConfig

<span class="comment"># åŠ¨æ€é…ç½®ç®¡ç†</span>
config = <span class="function">DynamicConfig</span>()
config.<span class="function">load_from_yaml</span>(<span class="string">"anp_open_sdk/config/dynamic_config.yaml"</span>)

<span class="comment"># æ ¸å¿ƒSDKåˆå§‹åŒ–</span>
sdk = <span class="function">ANPSDKCore</span>(config)

<span class="comment"># Agentå‘å¸ƒæœåŠ¡</span>
publisher = <span class="function">AgentPublisher</span>(sdk)

<span class="comment"># ç¾¤ç»„ç®¡ç†</span>
group_sdk = <span class="function">GroupSDK</span>(sdk)

<span class="comment"># ä½¿ç”¨serviceå±‚çš„å„ç§æœåŠ¡</span>
<span class="keyword">from</span> anp_open_sdk.service.agent_api_call <span class="keyword">import</span> AgentAPICall
<span class="keyword">from</span> anp_open_sdk.service.agent_message_group <span class="keyword">import</span> GroupMessageService
<span class="keyword">from</span> anp_open_sdk.service.local_agent_accelerator <span class="keyword">import</span> LocalAgentAccelerator

<span class="comment"># APIè°ƒç”¨æœåŠ¡</span>
api_service = <span class="function">AgentAPICall</span>(sdk)

<span class="comment"># ç¾¤ç»„æ¶ˆæ¯æœåŠ¡</span>
group_msg_service = <span class="function">GroupMessageService</span>(sdk)

<span class="comment"># æœ¬åœ°åŠ é€Ÿå™¨</span>
accelerator = <span class="function">LocalAgentAccelerator</span>(sdk)

<span class="comment"># è®¤è¯æœåŠ¡</span>
<span class="keyword">from</span> anp_open_sdk.auth.did_auth <span class="keyword">import</span> DIDAuth
<span class="keyword">from</span> anp_open_sdk.auth.token_auth <span class="keyword">import</span> TokenAuth

did_auth = <span class="function">DIDAuth</span>(config)
token_auth = <span class="function">TokenAuth</span>(config)

<span class="comment"># æ¶ˆæ¯å¤„ç†ç¤ºä¾‹</span>
<span class="decorator">@sdk.on_message</span>
<span class="keyword">async def</span> <span class="function">handle_message</span>(from_did, message):
    <span class="comment"># ä½¿ç”¨ç¾¤ç»„æ¶ˆæ¯æœåŠ¡å¤„ç†</span>
    result = <span class="keyword">await</span> group_msg_service.<span class="function">process_message</span>(from_did, message)
    <span class="keyword">return</span> result

<span class="comment"># APIå‘å¸ƒç¤ºä¾‹</span>
<span class="decorator">@publisher.publish_api</span>(<span class="string">"/api/my_service"</span>)
<span class="keyword">async def</span> <span class="function">my_api_handler</span>(request):
    <span class="comment"># ä½¿ç”¨APIè°ƒç”¨æœåŠ¡</span>
    response = <span class="keyword">await</span> api_service.<span class="function">call_external_api</span>(request)
    <span class="keyword">return</span> response

<span class="comment"># ç¾¤ç»„åˆ›å»ºç¤ºä¾‹</span>
<span class="keyword">async def</span> <span class="function">create_group_example</span>():
    group = <span class="keyword">await</span> group_sdk.<span class="function">create_group</span>(
        group_name=<span class="string">"æˆ‘çš„ç¾¤ç»„"</span>,
        description=<span class="string">"ç¾¤ç»„æè¿°"</span>
    )
    <span class="keyword">return</span> group

<span class="keyword">await</span> sdk.<span class="function">start</span>()</div>

<div class="features">
<div class="feature-card core">
<h3>ğŸ¯ æ ¸å¿ƒSDKæ¨¡å—</h3>
<ul>
<li><strong>anp_sdk.py:</strong> ä¸»è¦SDKå…¥å£å’Œæ ¸å¿ƒåŠŸèƒ½</li>
<li><strong>anp_agent_publisher.py:</strong> Agentå‘å¸ƒæœåŠ¡</li>
<li><strong>group_sdk.py:</strong> ç¾¤ç»„ç®¡ç†æ ¸å¿ƒ</li>
<li><strong>group_member_sdk.py:</strong> ç¾¤ç»„æˆå‘˜ç®¡ç†</li>
<li><strong>anp_user_tool.py:</strong> ç”¨æˆ·å·¥å…·é›†</li>
</ul>
</div>

<div class="feature-card service">
<h3>ğŸš€ service/ æœåŠ¡å±‚</h3>
<ul>
<li><strong>agent_api_call.py:</strong> Agent APIè°ƒç”¨æœåŠ¡</li>
<li><strong>agent_message_*.py:</strong> ç¾¤ç»„å’ŒP2Pæ¶ˆæ¯æœåŠ¡</li>
<li><strong>local_agent_accelerator.py:</strong> æœ¬åœ°æ€§èƒ½åŠ é€Ÿ</li>
<li><strong>router_*.py:</strong> å„ç§è·¯ç”±æœåŠ¡ï¼ˆAgentã€è®¤è¯ã€DIDã€å‘å¸ƒï¼‰</li>
</ul>
</div>

<div class="feature-card auth">
<h3>ğŸ” auth/ è®¤è¯å±‚</h3>
<ul>
<li><strong>did_auth.py:</strong> DIDå»ä¸­å¿ƒåŒ–èº«ä»½è®¤è¯</li>
<li><strong>token_auth.py:</strong> Tokenä»¤ç‰Œè®¤è¯</li>
<li><strong>jwt_keys.py:</strong> JWTå¯†é’¥ç®¡ç†</li>
<li><strong>custom_did_resolver.py:</strong> è‡ªå®šä¹‰DIDè§£æ</li>
<li><strong>vc_helper.py:</strong> å¯éªŒè¯å‡­è¯åŠ©æ‰‹</li>
</ul>
</div>

<div class="feature-card config">
<h3>âš™ï¸ config/ é…ç½®å±‚</h3>
<ul>
<li><strong>config.py:</strong> æ ¸å¿ƒé…ç½®ç®¡ç†</li>
<li><strong>dynamic_config.py:</strong> åŠ¨æ€é…ç½®æ”¯æŒ</li>
<li><strong>path_resolver.py:</strong> è·¯å¾„è§£æå’Œæ–‡ä»¶ç®¡ç†</li>
<li><strong>dynamic_config.yaml:</strong> YAMLé…ç½®æ–‡ä»¶</li>
</ul>
</div>
</div>

<div class="highlight">
<h3>ğŸ¯ å®é™…ä»£ç æ¶æ„ç‰¹ç‚¹</h3>
<p><strong>1. æ¨¡å—åŒ–è®¾è®¡:</strong> æ ¸å¿ƒSDKã€æœåŠ¡å±‚ã€è®¤è¯å±‚ã€é…ç½®å±‚æ¸…æ™°åˆ†ç¦»<br>
<strong>2. æœåŠ¡ä¸°å¯Œ:</strong> service/ ç›®å½•åŒ…å«9ä¸ªä¸“é—¨æœåŠ¡æ¨¡å—<br>
<strong>3. è®¤è¯å®Œæ•´:</strong> auth/ ç›®å½•æä¾›å®Œæ•´çš„DIDå’ŒJWTè®¤è¯ä½“ç³»<br>
<strong>4. é…ç½®çµæ´»:</strong> æ”¯æŒåŠ¨æ€é…ç½®å’Œè·¯å¾„è§£æ<br>
<strong>5. çƒ­è¡¥ä¸æ”¯æŒ:</strong> agent_connect_hotpatch/ æä¾›è¿æ¥å¢å¼º</p>
</div>

</div>
</div>

<script>
mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    themeVariables: {
        primaryColor: '#4facfe',
        primaryTextColor: '#333',
        primaryBorderColor: '#4facfe',
        lineColor: '#666',
        secondaryColor: '#00f2fe',
        tertiaryColor: '#f8f9fa',
        background: '#ffffff',
        mainBkg: '#ffffff',
        secondBkg: '#f8f9fa',
        tertiaryBkg: '#e3f2fd'
    },
    flowchart: {
        htmlLabels: true,
        curve: 'basis',
        nodeSpacing: 50,
        rankSpacing: 80
    }
});
</script>
</body>
</html>